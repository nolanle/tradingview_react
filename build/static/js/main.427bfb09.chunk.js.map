{"version":3,"sources":["api/axios.ts","api/index.ts","utils/socket.ts","components/KLineHeader.tsx","components/KLineWidget.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["https","axios","create","timeout","interceptors","request","use","config","a","url","baseURL","console","log","JSON","stringify","data","error","code","message","response","BASE_URL","API_URL","common_symbols","history_kline","apiGet","params","_url","get","catch","res","ws","success","failure","timer","evt","EventEmitter","this","WebSocket","binaryType","onopen","bind","onclose","onerror","onmessage","key","clearInterval","send","onReconnection","event","text","pako","inflate","to","parse","ping","pong","Date","now","onBroadcast","msg","ch","emit","name","callback","ee","readyState","OPEN","successPush","failurePush","remove","unsubscribe","removeAllListeners","unsub","cmd","on","initWebSocket","setInterval","dayJS","format","useStyles","makeStyles","theme","root","flexGrow","menu","marginRight","spacing","KLineHeader","props","styles","className","AppBar","position","Toolbar","variant","IconButton","edge","color","aria-label","onClick","Typography","title","INTERVAL","server","KLineWidget","interval","widget","datafeed","buttons","height","isMobile","RegExp","test","navigator","userAgent","fetchResolveSymbol","symbolName","Promise","resolve","symbol","display_name","toLocaleUpperCase","full_name","description","type","session","exchange","listed_exchange","timezone","pricescale","Math","pow","minmov","volume_precision","has_intraday","supported_resolutions","Object","keys","has_weekly_and_monthly","has_daily","fetchConfiguration","fetchKLineData","bars","size","window","innerWidth","firstDataRequest","meta","noData","resolution","unsubscribeKLine","period","length","i","item","push","time","id","open","high","low","close","volume","vol","sort","l","r","subscribeKLine","sub","subscribe","tick","updateKLine","initTradingView","locale","fullscreen","container_id","library_path","enabled_features","disabled_features","preset","headerReady","then","button","createButton","setAttribute","textContent","addEventListener","onButtonClick","addButtonColor","chart","setResolution","forceUpdate","getAttribute","style","onChangeSymbol","setSymbol","state","DataFeed","getBars","innerHeight","map","k","React","App","klineRef","onOpen","onClose","visible","setState","onSelected","list","obj","arr","fetchSymbolList","find","e","ref","SwipeableDrawer","ModalProps","onBackdropClick","List","dense","ListItem","selected","ListItemAvatar","Avatar","alt","src","ListItemText","primary","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.427bfb09.chunk.js","sourcesContent":["import axios from \"axios\";\n\nexport const https = axios.create({\n  timeout: 100000,\n});\n\n// 添加自定义实例请求拦截器\nhttps.interceptors.request.use(\n  async (config) => {\n    const url = `${config.baseURL || \"\"}${config.url}`;\n    console.log(` >> [REQUEST] ${url}: ${JSON.stringify(config.data)}`);\n    return config;\n  },\n  async (error) => {\n    const { code, message } = error;\n    console.log(` >> [REQUEST] error [${code}]: ${message}`);\n    return error;\n  }\n);\n\n// 添加自定义实例响应拦截器\nhttps.interceptors.response.use(\n  async (response) => {\n    const { config } = response;\n    console.log(\n      ` >> [RESPONSE] ${config.url}:`,\n      response.data ? response.data : response\n    );\n    return response;\n  },\n  async (error) => {\n    console.log(` >> [RESPONSE]:`, error?.config.url, error?.message);\n    return error;\n  }\n);\n","import { https } from \"./axios\";\nimport { AxiosRequestConfig } from \"axios\";\n\n// export const BASE_URL = \"/api\";\nexport const BASE_URL = \"https://api.huobi.pro\";\n\nexport const API_URL = {\n  /**\n   * 交易对\n   */\n  common_symbols: \"/v1/common/symbols\",\n  /**\n   * K线数据\n   */\n  history_kline: \"/market/history/kline\",\n};\n\nexport type UrlT = keyof typeof API_URL;\n\nexport async function apiGet<T>(\n  url: UrlT,\n  params?: string,\n  config?: AxiosRequestConfig\n) {\n  let _url = API_URL[url];\n  _url = _url ? `${BASE_URL}${_url}` : url;\n  _url = params ? _url + params : _url;\n  const res = await https.get<IApiResponse<T>>(_url, config).catch(() => {\n    return;\n  });\n  return res ? res.data : void 0;\n}\n\nexport async function apiPost<T, P = any>(\n  url: UrlT,\n  params?: P,\n  config?: AxiosRequestConfig\n) {\n  let _url = API_URL[url];\n  _url = _url ? `${BASE_URL}${_url}` : url;\n  const res = await https\n    .post<IApiResponse<T>>(_url, params, config)\n    .catch(() => {\n      return;\n    });\n  return res ? res.data : void 0;\n}\n","import pako from \"pako\";\nimport dayJS from \"dayjs\";\nimport { EventEmitter } from \"events\";\n\nclass TvWebSocket {\n  private url = \"wss://api.huobi.pro/ws\";\n  private ws: WebSocket | null = null;\n  private success: IUtilsMap<string> = {};\n  private failure: IUtilsMap<string> = {};\n  private timer: NodeJS.Timeout | null = null;\n  private evt = new EventEmitter();\n\n  public initWebSocket() {\n    this.ws = new WebSocket(this.url);\n    this.ws.binaryType = \"arraybuffer\";\n    this.ws.onopen = this.onopen.bind(this);\n    this.ws.onclose = this.onclose.bind(this);\n    this.ws.onerror = this.onerror.bind(this);\n    this.ws.onmessage = this.onmessage.bind(this);\n    console.log(\" >> WebSocket init :\", this.url);\n  }\n\n  private onopen() {\n    if (!this.ws) {\n      return;\n    }\n    console.log(\" >> WebSocket open...\");\n    if (this.timer) {\n      clearInterval(this.timer);\n      this.timer = null;\n      // 断线重新订阅\n      for (const key in this.success) {\n        this.ws.send(this.success[key]);\n        console.log(` >> WebSocket send: ${this.success[key]}`);\n      }\n    }\n    // 失败重新订阅\n    for (const key in this.failure) {\n      if (this.success[key]) {\n        continue;\n      }\n      this.ws.send(this.failure[key]);\n      this.success[key] = this.failure[key];\n      console.log(` >> WebSocket send: ${this.failure[key]}`);\n    }\n    this.failure = {};\n  }\n\n  private onclose() {\n    this.ws = null;\n    console.log(\" >> Websocket Close...\");\n    if (!this.timer) {\n      this.onReconnection();\n    }\n  }\n\n  private onerror(event: Event) {\n    console.log(\" >> Websocket Error...\", event);\n  }\n\n  private onmessage(event: MessageEvent<string>) {\n    if (!event.data) {\n      return;\n    }\n    const text = pako.inflate(event.data, {\n      to: \"string\",\n    });\n    const data = JSON.parse(text);\n    // console.log(\"---inflate----\", data);\n    if (data && data.ping) {\n      this.ws?.send(\n        JSON.stringify({\n          pong: Date.now(),\n        })\n      );\n      return;\n    }\n    this.onBroadcast(data);\n  }\n\n  /**\n   * 广播通知\n   */\n  private onBroadcast(msg: any) {\n    if (!this.success[msg.ch]) {\n      return;\n    }\n    this.evt.emit(msg.ch, msg);\n  }\n\n  public subscribe(\n    name: string,\n    params: any,\n    callback: (...args: any[]) => void\n  ) {\n    let ee: EventEmitter;\n    if (!this.ws || this.ws.readyState !== WebSocket.OPEN) {\n      ee = this.failurePush(name, params, callback);\n    } else {\n      ee = this.successPush(name, params, callback);\n    }\n    return {\n      remove: () => {\n        this.unsubscribe(name);\n        ee.removeAllListeners(name);\n      },\n    };\n  }\n\n  public unsubscribe(name: string) {\n    if (this.failure[name]) {\n      delete this.failure[name];\n    }\n    if (!this.success[name]) {\n      return;\n    }\n    if (!this.ws) {\n      delete this.success[name];\n      return;\n    }\n    const unsub = JSON.parse(this.success[name]);\n    unsub.cmd = \"unsub\";\n    this.ws.send(JSON.stringify(unsub));\n    this.evt.removeAllListeners(name);\n    console.log(` >> WebSocket send: ${JSON.stringify(unsub)}`);\n    delete this.success[name];\n  }\n\n  private successPush(\n    name: string,\n    params: any,\n    callback: (...args: any[]) => void\n  ) {\n    this.success[name] = JSON.stringify(params);\n    this.ws?.send(this.success[name]);\n    console.log(` >> WebSocket send: ${this.success[name]}`);\n    return this.evt.on(name, callback);\n  }\n\n  private failurePush(\n    name: string,\n    params: any,\n    callback: (...args: any[]) => void\n  ) {\n    this.failure[name] = JSON.stringify(params);\n    console.log(` >> WebSocket 准备订阅: ${this.failure[name]}`);\n    return this.evt.on(name, callback);\n  }\n\n  /**\n   * 断线重连\n   */\n  private onReconnection() {\n    if (!this.url) {\n      return;\n    }\n    this.initWebSocket();\n    this.timer = setInterval(() => {\n      this.initWebSocket();\n      const now = dayJS().format(\"YYYY-MM-DD HH:mm:ss\");\n      console.log(` >> [${now}] WebSocket Reconnect....`);\n    }, 3000);\n  }\n}\n\nexport const ws = new TvWebSocket();\n","import React from \"react\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport MenuIcon from \"@material-ui/icons/Menu\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    flexGrow: 1,\n  },\n  menu: {\n    marginRight: theme.spacing(2),\n  },\n}));\n\ntype Props = {\n  title: string;\n  onClick: () => void;\n};\nexport function KLineHeader(props: Partial<Props>) {\n  const styles = useStyles();\n\n  return (\n    <div className={styles.root}>\n      <AppBar position=\"static\">\n        <Toolbar variant=\"dense\">\n          <IconButton\n            edge=\"start\"\n            color=\"inherit\"\n            aria-label=\"menu\"\n            className={styles.menu}\n            onClick={props.onClick}\n          >\n            <MenuIcon />\n          </IconButton>\n          <Typography variant=\"h6\" color=\"inherit\">\n            {props.title}\n          </Typography>\n        </Toolbar>\n      </AppBar>\n    </div>\n  );\n}\n","import * as React from \"react\";\nimport { apiGet } from \"../api\";\nimport { ws } from \"../utils/socket\";\nimport { LibrarySymbolInfo } from \"tradingview-api/lib/library.min\";\nimport { DatafeedConfiguration } from \"tradingview-api/lib/library.min\";\nimport { IChartingLibraryWidget, Bar } from \"tradingview-api/lib/library.min\";\nimport { DataFeed, GetBarsParams, widget } from \"tradingview-api\";\n\nconst INTERVAL = {\n  \"1\": { server: \"1min\", name: \"1m\" },\n  \"5\": { server: \"5min\", name: \"5m\" },\n  // \"15\": { server: \"15min\", name: \"15m\" },\n  \"30\": { server: \"30min\", name: \"30m\" },\n  \"60\": { server: \"60min\", name: \"1h\" },\n  \"240\": { server: \"4hour\", name: \"4h\" },\n  \"1440\": { server: \"1day\", name: \"1D\" },\n  \"10080\": { server: \"1week\", name: \"1W\" },\n  \"302400\": { server: \"1mon\", name: \"1M\" },\n};\n\ntype KeyT = keyof typeof INTERVAL;\ntype Props = {\n  symbol: IApiSymbols;\n};\ntype State = {};\nexport class KLineWidget extends React.Component<Partial<Props>, State> {\n  private interval: KeyT = \"5\";\n  private widget?: IChartingLibraryWidget;\n  private datafeed: DataFeed;\n  private buttons: Array<HTMLElement> = [];\n  private height: number;\n\n  constructor(props: Partial<Props>) {\n    super(props);\n    this.state = {};\n    this.datafeed = new DataFeed({\n      getBars: this.fetchKLineData,\n      fetchResolveSymbol: this.fetchResolveSymbol,\n      fetchConfiguration: this.fetchConfiguration,\n    });\n    this.height = window.innerHeight - (this.isMobile() ? 88 : 48);\n  }\n\n  public isMobile = () => {\n    const reg = new RegExp(\"(iPhone|iPad|iPod|iOS|Android)\", \"i\");\n    return reg.test(navigator.userAgent);\n  };\n\n  public fetchResolveSymbol = (\n    symbolName: string\n  ): Promise<LibrarySymbolInfo> => {\n    return new Promise((resolve) => {\n      const symbol = this.props.symbol!;\n      const display_name = `${symbol[\n        \"base-currency\"\n      ].toLocaleUpperCase()}/${symbol[\"quote-currency\"].toLocaleUpperCase()}`;\n      resolve({\n        name: display_name,\n        full_name: display_name,\n        description: symbolName,\n        type: \"stock\",\n        session: \"24x7\",\n        exchange: \"\",\n        listed_exchange: \"\",\n        timezone: \"Asia/Shanghai\",\n        format: \"price\",\n        pricescale: Math.pow(10, symbol[\"price-precision\"]),\n        minmov: 1,\n        volume_precision: symbol[\"value-precision\"],\n        has_intraday: true,\n        supported_resolutions: Object.keys(INTERVAL),\n        has_weekly_and_monthly: true,\n        has_daily: true,\n      });\n    });\n  };\n\n  public fetchConfiguration = () => {\n    return new Promise<DatafeedConfiguration>((resolve) => {\n      resolve({\n        supported_resolutions: Object.keys(INTERVAL),\n      });\n    });\n  };\n\n  public fetchKLineData = async (params: GetBarsParams) => {\n    const bars: Bar[] = [];\n    const size = window.innerWidth;\n    if (!params.firstDataRequest) {\n      // 火币接口暂时不支持分段查询历史数据\n      return { bars, meta: { noData: true } };\n    }\n    if (params.resolution !== this.interval) {\n      this.unsubscribeKLine();\n      this.interval = params.resolution as KeyT;\n    }\n    const res = await apiGet<Array<IApiKLine>>(\"history_kline\", void 0, {\n      params: {\n        symbol: this.props.symbol?.symbol,\n        period: INTERVAL[this.interval].server,\n        size: size > 2000 ? 2000 : size,\n      },\n    });\n    if (!res || !res.data || !res.data.length) {\n      return { bars, meta: { noData: true } };\n    }\n    for (let i = 0; i < res.data.length; i++) {\n      const item = res.data[i];\n      bars.push({\n        time: item.id * 1000,\n        open: item.open,\n        high: item.high,\n        low: item.low,\n        close: item.close,\n        volume: item.vol,\n      });\n    }\n    bars.sort((l, r) => (l.time > r.time ? 1 : -1));\n    if (params.firstDataRequest) {\n      this.subscribeKLine();\n    }\n    return { bars, meta: { noData: true } };\n  };\n\n  public subscribeKLine = () => {\n    const symbol = this.props.symbol?.symbol;\n    const interval = INTERVAL[this.interval].server;\n    const sub = `market.${symbol}.kline.${interval}`;\n    ws.subscribe(sub, { id: \"tv\", sub: sub }, (data) => {\n      const tick = data.tick as IApiKLine;\n      this.datafeed.updateKLine({\n        time: tick.id * 1000,\n        open: tick.open,\n        high: tick.high,\n        low: tick.low,\n        close: tick.close,\n        volume: tick.vol,\n      });\n    });\n  };\n\n  public unsubscribeKLine = () => {\n    const symbol = this.props.symbol?.symbol;\n    const interval = INTERVAL[this.interval].server;\n    ws.unsubscribe(`market.${symbol}.kline.${interval}`);\n  };\n\n  public initTradingView = () => {\n    const symbol = this.props.symbol!;\n    const display_name = `${symbol[\n      \"base-currency\"\n    ].toLocaleUpperCase()}/${symbol[\"quote-currency\"].toLocaleUpperCase()}`;\n    this.widget = new widget({\n      locale: \"zh\",\n      theme: \"Light\",\n      fullscreen: false,\n      symbol: display_name,\n      interval: this.interval,\n      container_id: \"tv_chart_container\",\n      datafeed: this.datafeed,\n      library_path: \"./charting_library/\",\n      timezone: \"Asia/Shanghai\",\n      enabled_features: [\"hide_last_na_study_output\"],\n      disabled_features: [\n        \"volume_force_overlay\",\n        \"header_resolutions\",\n        \"header_compare\",\n        \"header_undo_redo\",\n      ],\n      preset: this.isMobile() ? \"mobile\" : void 0,\n    });\n    this.widget\n      .headerReady()\n      .then(() => {\n        this.buttons = [];\n        if (this.isMobile()) {\n          return;\n        }\n        for (let key in INTERVAL) {\n          const item = INTERVAL[key as KeyT];\n          const button = this.widget!.createButton();\n          button.setAttribute(\"interval\", key);\n          button.textContent = item.name;\n          button.addEventListener(\"click\", () => this.onButtonClick(key));\n          this.buttons.push(button);\n        }\n        this.addButtonColor();\n      })\n      .catch(() => {});\n  };\n\n  public onButtonClick = (resolution: string) => {\n    if (resolution === this.interval) {\n      return;\n    }\n    this.widget!.chart().setResolution(resolution, () => {\n      if (this.isMobile()) {\n        this.forceUpdate();\n      } else {\n        this.addButtonColor();\n      }\n    });\n  };\n\n  public addButtonColor = () => {\n    for (let button of this.buttons) {\n      const interval = button.getAttribute(\"interval\");\n      if (interval === this.interval) {\n        button.style.color = \"#1878F3\";\n      } else {\n        button.style.color = \"#131722\";\n      }\n    }\n  };\n\n  public onChangeSymbol = (symbol: IApiSymbols) => {\n    this.unsubscribeKLine();\n    this.widget?.setSymbol(\n      `${symbol[\"base-currency\"].toLocaleUpperCase()}/${symbol[\n        \"quote-currency\"\n      ].toLocaleUpperCase()}`,\n      this.interval,\n      () => {}\n    );\n  };\n\n  public componentDidMount() {}\n\n  public componentWillUnmount() {\n    this.widget && this.widget.remove();\n  }\n\n  public render() {\n    return (\n      <div className=\"kline-wrapp\">\n        {this.isMobile() ? (\n          <div className=\"kline-list\">\n            {Object.keys(INTERVAL).map((k) => {\n              return (\n                <div\n                  key={k}\n                  className=\"kline-item\"\n                  onClick={() => this.onButtonClick(k)}\n                  style={{ color: k === this.interval ? \"#1878F3\" : \"#131722\" }}\n                >\n                  {INTERVAL[k as KeyT].name}\n                </div>\n              );\n            })}\n          </div>\n        ) : null}\n        <div\n          id=\"tv_chart_container\"\n          style={{ height: window.innerHeight - 48 }}\n        />\n      </div>\n    );\n  }\n}\n","import * as React from \"react\";\nimport { apiGet } from \"./api\";\nimport { ws } from \"./utils/socket\";\nimport { KLineHeader } from \"./components/KLineHeader\";\nimport { KLineWidget } from \"./components/KLineWidget\";\nimport SwipeableDrawer from \"@material-ui/core/SwipeableDrawer\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport ListItemAvatar from \"@material-ui/core/ListItemAvatar\";\nimport Avatar from \"@material-ui/core/Avatar\";\n\nconst icon_url = \"https://static.okex.com/cdn/oksupport/asset/currency/icon/\";\n\ntype Props = {};\ntype State = {\n  code: string;\n  visible: boolean;\n  list: Array<IApiSymbols>;\n};\nclass App extends React.Component<Props, State> {\n  private klineRef: KLineWidget | null = null;\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      code: \"btcusdt\",\n      visible: false,\n      list: [],\n    };\n  }\n\n  public async fetchSymbolList() {\n    const res = await apiGet<IApiSymbols[]>(\"common_symbols\");\n    if (!res || !res.data) {\n      return;\n    }\n    const obj: IUtilsMap<IApiSymbols> = {};\n    for (let i = 0; i < res.data.length; i++) {\n      const item = res.data[i];\n      if (\n        item.state === \"online\" &&\n        item[\"quote-currency\"] === \"usdt\" &&\n        !/\\d/.test(item[\"base-currency\"])\n      ) {\n        obj[item[\"base-currency\"]] = item;\n      }\n    }\n    const arr = Object.keys(obj).sort();\n    this.setState({ list: arr.map((k) => obj[k]) });\n  }\n\n  public componentDidMount() {\n    ws.initWebSocket();\n    this.fetchSymbolList().then(() => {\n      this.klineRef && this.klineRef.initTradingView();\n    });\n  }\n\n  public onOpen = () => {};\n\n  public onClose = () => {};\n\n  public onClick = () => {\n    const { visible } = this.state;\n    this.setState({ visible: !visible });\n  };\n\n  public onSelected = (item: IApiSymbols) => {\n    const { code } = this.state;\n    if (code !== item.symbol) {\n      this.setState({ code: item.symbol });\n      this.klineRef && this.klineRef.onChangeSymbol(item);\n    }\n    this.onClick();\n  };\n\n  public render() {\n    const { code, visible, list } = this.state;\n    const symbol = list.find((e) => e.symbol === code);\n    const title = symbol\n      ? `${symbol[\"base-currency\"].toLocaleUpperCase()}/${symbol[\n          \"quote-currency\"\n        ].toLocaleUpperCase()}`\n      : \"\";\n    return (\n      <div className=\"kline\">\n        <KLineHeader onClick={this.onClick} title={title} />\n        <KLineWidget symbol={symbol} ref={(ref) => (this.klineRef = ref)} />\n        <SwipeableDrawer\n          open={visible}\n          onOpen={this.onOpen}\n          onClose={this.onClose}\n          ModalProps={{ onBackdropClick: this.onClick }}\n        >\n          <List dense={true}>\n            {list.map((e, i) => {\n              return (\n                <ListItem\n                  key={e.symbol}\n                  button={true}\n                  selected={code === e.symbol}\n                >\n                  <ListItemAvatar>\n                    <Avatar\n                      alt={`Avatar n°${i + 1}`}\n                      src={`${icon_url}${e[\"base-currency\"]}.png?x-oss-process=image/format,webp`}\n                    />\n                  </ListItemAvatar>\n                  <ListItemText\n                    style={{\n                      color: code === e.symbol ? \"red\" : \"inherit\",\n                    }}\n                    primary={`${e[\"base-currency\"].toLocaleUpperCase()}/${e[\n                      \"quote-currency\"\n                    ].toLocaleUpperCase()}`}\n                    onClick={() => this.onSelected(e)}\n                  />\n                </ListItem>\n              );\n            })}\n          </List>\n        </SwipeableDrawer>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import { ReportHandler } from \"web-vitals\";\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import(\"web-vitals\").then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}